{% extends 'central-base.html' %}
{% load static %}

{% block nuevoRegistro %}
  <div class="bg-white">
    <form action="." method="POST">
      {% csrf_token %}
      <div class="flex flex-col items-center justify-center bg-zinc-400 text-center my-6 mx-4">
        <div class="my-3 text-2xl font-semibold">
          <h1>Registra Un Camion</h1>
        </div>
        <div class="col-start-2 grid my-2">
          <label for="tracto">Tracto</label>
          <input 
            type="text" 
            name="tracto" 
            placeholder="Ingrese el número de tracto"
            maxlength="4"
            required
          >        
        </div>

        <div class="col-start-2 grid my-2">
          <label for="cargado">Cargado</label>
          <input 
            type="checkbox" 
            name="cargado" 
            value="1"
            id="cargado"
          >
        </div>
      
        <div class="col-start-2 grid my-2">
          <label for="hora">Hora:</label>
          <input 
            type="datetime-local" 
            name="fecha" 
            required
            value=""
            onfocus="setDateTime()"
          >
        </div>
      
        <div class="col-start-2 grid my-2">
          <label for="ppu">PPU</label>
          <input 
            type="text" 
            name="ppu" 
            required 
            maxlength="6"
          >
        </div>
      
        <div class="my-2">
          <label class="my-2 col-start-2 grid" for="comienzoContenedor">Contenedor</label>
          <input 
            type="text" 
            name="comienzoContenedor" 
            required 
            maxlength="10"
            id="comienzoContenedor"
          >
          <label for="finalContenedor"> - </label>
          <input 
            type="text" 
            name="finalContenedor" 
            required 
            maxlength="1"
            id="finalContenedor"
          >          
        </div>
      
        <div class="my-2 col-start-2 grid">
          <label for="sello">Sello</label>
          <input 
            type="text" 
            name="sello" 
            required
            maxlength="8"
            id="sello"
          >
        </div>
        
      
        <div class="my-2 col-start-2 grid">
          <label class="my-2" for="idConductor">Conductor</label>
          <select id="idConductor" name="idConductor" required>
            <!-- Options for idConductor selection -->
            {% for e in conductores %}
            <option value="{{ e.id }}"> {{ e.nombre }} </option>
            {% endfor %}
          </select>
        </div>
      
        <div class="my-2 col-start-2 grid">
          <label class="my-2" for="idCamion">Tipo de camión</label>
          <select name="idCamion" required>
            <!-- Options for idCamion selection -->
            {% for e in camiones %}
            <option value="{{ e.id }}"> {{ e.nombre }} </option>
            {% endfor %}
          </select>
        </div>
      
        <div class="my-2">
          <p> Este registro será guardado bajo la responsabilidad de <i> {{ autor.nombre }} </i> </p>
        </div>
      
        <button class="bg-amber-500 text-white px-4 py-2 rounded-md my-4" type="submit">Enviar</button>        
      </div>
        
      <!--Funcion en javascript para que la hora se ponga automaticamente-->
      <script>
        function setDateTime() {
          const dateInput = document.querySelector('input[name="fecha"]');
          const now = new Date();
          const year = now.getFullYear();
          const month = String(now.getMonth() + 1).padStart(2, '0');
          const day = String(now.getDate()).padStart(2, '0');
          const hours = String(now.getHours()).padStart(2, '0');
          const minutes = String(now.getMinutes()).padStart(2, '0');
        
          // El valor del campo datetime-local debe tener el formato "AAAA-MM-DDThh:mm"
          const dateTimeValue = `${year}-${month}-${day}T${hours}:${minutes}`;
          dateInput.value = dateTimeValue;
        }
        </script>

      <!--funcion en javascript para que cuando el camion no vaya cargado no se pueda escribir el n° del contenedor y el n° de sello-->
      <script>
        const cargado = document.getElementById('cargado');
        const comienzoContenedor = document.getElementById('comienzoContenedor');
        const finalContenedor = document.getElementById('finalContenedor');
        const sello = document.getElementById('sello');
      
        cargado.addEventListener('change', () => {
          if (cargado.checked) {
            // Si el cargado está marcado (cargado es igual a 1), habilitar los campos
            comienzoContenedor.disabled = false;
            finalContenedor.disabled = false;
            sello.disabled = false;
          } else {
            // Si el cargado no está marcado (cargado es igual a 0), deshabilitar los campos
            comienzoContenedor.disabled = true;
            sello.disabled = true;
            finalContenedor.disabled = true;
          }
        });
      </script>
    
      
    </form>
  </div>

{% endblock %}
  